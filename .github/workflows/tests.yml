name: Tests

on:
  push:
    branches:
      - development
  pull_request:
    branches:
      - main
      - development

jobs:
  tests:
    runs-on: ubuntu-latest
    services:
        mongodb:
          image: mongo
          ports:
            - 27017:27017
    steps:
        - name: Checkout
          uses: actions/checkout@v2

        - name: Set up Docker Compose
          run: docker compose -f docker-compose-dev.yml up -d

        - name: Setup Bun
          uses: oven-sh/setup-bun@v1.1.1
        
        - name: Run Tests
          run: bun install && bun test
          
        - name: Tear down Docker Compose
          run: docker-compose down